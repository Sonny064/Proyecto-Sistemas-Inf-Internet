<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough">
   <h:head>
        <link rel='stylesheet' type='text/css' href='resources/css/bootstrap.min.css'></link>
        <link rel='stylesheet' type='text/css' href='resources/css/propia.css'></link>
        <title>Login de la aplicacion</title>
   </h:head>
    <h:body>
      <nav class="navbar navbar-expand-lg navbar-light customnav">
          <img src="img/logo.png" alt="logo" style="height: 40px; margin-right: 25px"/>
           <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null and sesion.isTrabajador()?'block':'none'}" href="/ACOES-war/faces/proyectos.xhtml">Proyectos</a>
           <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null?'block':'none'}" href="/ACOES-war/faces/centros.xhtml">Centros</a>
           <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null?'block':'none'}" href="/ACOES-war/faces/personal.xhtml">Personal</a>
           <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null?'block':'none'}" href="/ACOES-war/faces/socios.xhtml">Socios</a>
           <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null?'block':'none'}" href="/ACOES-war/faces/beneficiarios.xhtml">Beneficiarios</a>
           <div class="container" style="position: absolute; right: 15px; max-width: 250px">
            <a class="navbar-brand especial" style="display:#{sesion.getUser()==null?'block':'none'}" href="/ACOES-war/faces/login.xhtml">Iniciar sesión</a>
            <a class="navbar-brand especial" style="display:#{sesion.getUser()==null?'block':'none'}" href="/ACOES-war/faces/registro.xhtml">Registrarse</a>
            <a class="navbar-brand especial" style="display:#{sesion.getUser()!=null?'block':'none'}" href="/ACOES-war/faces/perfil.xhtml">Hola #{sesion.nombre()}!</a>
            <h:form>
                <h:commandButton value="Salir" class="btn btn-primary btn-sm" style="display:#{sesion.getUser()!=null?'block':'none'}" action="#{sesion.close()}"/>
            </h:form>
           </div>
      </nav>
        <c:if test="#{sesion.isTrabajador()}">
            <div class="container" style="margin-top: 25px">
                <div class="row">
                    <h:form style="padding-left: 1em;">
                        <h:commandButton value="Refrescar" class="btn btn-primary btn-sm" action="#{proyectos.refresh()}"/>
                    </h:form>
                    <c:if test="#{sesion.admin()}">
                    <h:form style="padding-left: 1em;">
                        <h:commandButton value="Añadir" class="btn btn-primary btn-sm" action="#{proyectos.enableEditor()}"/>
                    </h:form>
                    </c:if>
                </div>
            </div>
            <div class="container" style="display:#{proyectos.editor?'block':'none'}; margin-top: 1em">
                <h:form>
                    <div class="row">
                            <div class="form-group col-md-4">
                         <h:outputLabel  value="Nombre" class="especial" lang="es"/>
                         <h:inputText id="nombre" lang="es" class="form-control"  value="#{proyectos.proyecto.nombre}" required="true"/>
                    </div>
                    <div class="form-group col-md-4"> 
                        <h:outputLabel  value="Fecha de cración" class="especial" lang="es"/>
                        <h:inputText id="fechacreacion" class="form-control" value="#{proyectos.proyecto.fechadecreacion}" a:placeholder="DD/MM/AAAA" required="true">
                            <f:convertDateTime pattern="dd/MM/yyyy"/>
                        </h:inputText>
                    </div>
                    </div>
                    <div class="row">
                        <div class="form-group col-md-8">
                            <h:outputLabel  value="Descripción" class="especial" lang="es"/>
                            <h:inputText id="desc" lang="es" class="form-control"  value="#{proyectos.proyecto.descripcion}" required="true"/>
                        </div>
                    </div>
                    <div class="row" style="padding-left: 1em">
                        <h:commandButton value="Añadir" class="btn btn-primary btn-sm" style="display:#{proyectos.proyecto.id==null or proyectos.proyecto.id==0?'block':'none'};" action="#{proyectos.insert()}"/>
                        <h:commandButton value="Actualizar" class="btn btn-primary btn-sm" style="display:#{proyectos.proyecto.id!=null and proyectos.proyecto.id!=0?'block':'none'};" action="#{proyectos.update(proyectos.proyecto)}"/>
                        <h:commandButton value="Cancelar" class="btn btn-secondary btn-sm" style="margin-left: 1em" action="#{proyectos.disableEditor()}"/>
                    </div>
             </h:form>
            </div>
            
            
      <div class="container">
        <div class="d-flex justify-content-center h-100" style="margin-top: 25px">
            <h:dataTable style ="width: 100%" value="#{proyectos.list}" var="p"
    			styleClass="order-table"
    			headerClass="order-table-header"
    			rowClasses="order-table-odd-row,order-table-even-row">

    			<h:column>
    				<f:facet name="header">ID</f:facet>
    				#{p.id}
    			</h:column>
    			
    			<h:column>
    				<f:facet name="header">Proyecto</f:facet>
    				#{p.nombre}
    			</h:column>
    			
    			<h:column>
    				<f:facet name="header">Fecha de creación</f:facet>
                                <h:outputText value="#{p.fechadecreacion}">
                                  <f:convertDateTime pattern="dd-MM-yyyy" />
                                </h:outputText>
    			</h:column>
    			
    			<h:column>
    				<f:facet name="header">Descripción</f:facet>
    				#{p.descripcion}
    			</h:column>
                        
                        <c:if test="#{sesion.admin()}">
                        <h:column>
                            <f:facet name="header">Acciones</f:facet>
                            <h:form>
                                <h:commandButton value="Actualizar" class="btn btn-primary btn-sm"  style="margin-right: 1em;" action="#{proyectos.enableEditor(p)}"/>
                                <h:commandButton value="Eliminar" class="btn btn-primary btn-sm" action="#{proyectos.delete(p)}"/>
                            </h:form>
                        </h:column>
                    </c:if>

    		</h:dataTable>
        </div>
     </div>
        </c:if>
   </h:body>
</html>
